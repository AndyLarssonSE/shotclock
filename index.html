<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AndyLarsson.se - Pool & Billiard Timer</title>
<style>
  :root{
    --bg-top:#282727;
    --bg-bot:#161616;
    --text:#ffffff;
    --muted:#cfd3d8;
    --divider:#e7f0ee;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    color:var(--text);
    font-family: ui-sans-serif, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
    background: linear-gradient(to bottom, var(--bg-top), var(--bg-bot));
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }

  /* Header: names + race */
  .top{
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    gap:12px;
    padding:14px 14px 0;
    align-items:end;
    text-transform:uppercase;
    letter-spacing:.06em;
    font-weight:900;
  }
  .label{color:var(--muted); font-weight:800; margin-bottom:2px}
  .name{font-size:14px}
  .score{font-size:42px; line-height:1; font-variant-numeric: tabular-nums}
  .race{text-align:center}
  .race .to{font-size:14px; color:var(--muted)}
  .race .target{font-size:38px}
  .race .edit-race{margin-top:6px; display:flex; justify-content:center}

  /* Timer */
  .timer{
    text-align:center;
    font-size: clamp(110px, 22vw, 210px);
    line-height:1;
    margin:6px 0 0;
    font-weight:900;
    font-variant-numeric: tabular-nums;
  }

  /* Main two columns + divider */
  .main{
    display:grid;
    grid-template-columns: 1fr 2px 1fr;
    gap:14px;
    padding:12px 12px 22px;
  }
  .divider{
    width:2px;
    background: linear-gradient(180deg, transparent, var(--divider), transparent);
    border-radius:1px;
  }

  .side{display:flex; flex-direction:column; align-items:center; gap:16px}

  /* Image buttons */
  .imgbtn, .imgbtn-small{
    display:inline-block;
    border:0; background:none; padding:0; margin:0; cursor:pointer;
    width: min(50%, 320px);
  }
  .imgbtn img, .imgbtn-small img{
    display:block; width:100%; height:auto; border-radius:14px;
    box-shadow: 0 8px 16px rgba(0,0,0,.35);
    transition: transform .05s ease, filter .1s ease;
  }
  .imgbtn:active img, .imgbtn-small:active img{ transform: translateY(1px); filter:brightness(.96) }

  .row{display:flex; gap:14px; justify-content:center; width:100%}
  .row.center{margin-top:4px}

  /* smaller buttons row (clock controls + reset score/race/name) */
  .imgbtn-small{ width:min(44vw, 110px) }
  .center-stack{ display:flex; flex-direction:column; align-items:center; gap:12px }

  /* Safe-area padding on iOS */
  @supports (padding: env(safe-area-inset-bottom)){
    body{padding-bottom: env(safe-area-inset-bottom)}
  }
</style>
</head>
<body>

  <!-- TOP -->
  <div class="top">
    <div class="left">
      <div class="name" id="p1Name">PLAYER1</div>
      <div class="score" id="p1Score">0</div>
    </div>

    <div class="race">
      <div class="to">Race To</div>
      <div class="target" id="raceTo">8</div>
      <div class="edit-race">
        <button class="imgbtn-small" id="editRaceBtn" aria-label="Edit Race">
          <img id="imgEditRace" alt="Edit Race">
        </button>
      </div>
    </div>

    <div class="right" style="text-align:right">
      <div class="name" id="p2Name">PLAYER2</div>
      <div class="score" id="p2Score">0</div>
    </div>
  </div>

  <!-- TIMER -->
  <div class="timer" id="timer">30</div>

  <!-- MAIN -->
  <div class="main">
    <!-- LEFT SIDE -->
    <div class="side">
      <button class="imgbtn" id="p1StatusBtn" aria-label="Left status">
        <img id="imgP1Status" alt="STATUS">
      </button>
      <button class="imgbtn" id="p1Plus" aria-label="Left +1 point">
        <img id="imgP1Plus" alt="+1 POINT">
      </button>
      <button class="imgbtn" id="p1Ext" aria-label="Left extension">
        <img id="imgP1Ext" alt="EXTENSION">
      </button>
    </div>

    <div class="divider" aria-hidden="true"></div>

    <!-- RIGHT SIDE -->
    <div class="side">
      <button class="imgbtn" id="p2StatusBtn" aria-label="Right status">
        <img id="imgP2Status" alt="STATUS">
      </button>
      <button class="imgbtn" id="p2Plus" aria-label="Right +1 point">
        <img id="imgP2Plus" alt="+1 POINT">
      </button>
      <button class="imgbtn" id="p2Ext" aria-label="Right extension">
        <img id="imgP2Ext" alt="EXTENSION">
      </button>
    </div>
  </div>

  <!-- LOWER CONTROLS -->
  <div class="row center">
    <button class="imgbtn-small" id="pauseBtn" aria-label="Clock Paused">
      <img id="imgPause" alt="Clock Paused">
    </button>
    <button class="imgbtn-small" id="startBtn" aria-label="Clock Running">
      <img id="imgStart" alt="Clock Running">
    </button>
    <button class="imgbtn-small" id="resetClockBtn" aria-label="Reset Clock">
      <img id="imgResetClock" alt="Reset Clock">
    </button>
  </div>

  <div class="center-stack" style="margin-top:10px">
    <button class="imgbtn-small" id="resetScoreBtn" aria-label="Reset Score">
      <img id="imgResetScore" alt="Reset Score" src="assets/reset-score-button.png">
    </button>
  </div>

  <div class="row center" style="margin-top:4px">
    <button class="imgbtn-small" id="editP1" aria-label="Edit Player 1 Name">
      <img id="imgEditNameL" alt="Edit Name (Left)">
    </button>
    <button class="imgbtn-small" id="editP2" aria-label="Edit Player 2 Name">
      <img id="imgEditNameR" alt="Edit Name (Right)">
    </button>
  </div>

<script>
/* ---------- Image file names (match your actual /assets/ files) ---------- */
const IMG = {
  p1Status_waiting: 'assets/status-waiting-left.png',
  p1Status_playing: 'assets/status-playing-left.png',

  p2Status_waiting: 'assets/status-waiting-right.png',
  p2Status_playing: 'assets/status-playing-right.png',

  p1Plus: 'assets/plus1-left.png',
  p2Plus: 'assets/plus1-right.png',

  p1Ext_ready:  'assets/extension-left.png',
  p1Ext_used:   'assets/extension-called-left.png',
  p2Ext_ready:  'assets/extension-right.png',
  p2Ext_used:   'assets/extension-called-right.png',

  /* fixed & consistent control names */
  start:        'assets/start-clock-button.png',
  running:      'assets/clock-running.png',
  pause:        'assets/pause-clock-button.png',
  resetClock:   'assets/reset-clock.png',

  editName:     'assets/edit-name-button.png',
  editRace:     'assets/edit-race-button.png'
};

/* Preload helper so images show instantly */
function setImg(id, src, fallbackText){
  const img = document.getElementById(id);
  img.src = src;
  img.onerror = () => { img.alt = fallbackText || id; };
}

/* ---------- State ---------- */
let p1 = { name:'PLAYER1', score:0, usedExt:false, playing:true };
let p2 = { name:'PLAYER2', score:0, usedExt:false, playing:false };
let raceTo = 8;

let sec = 30, timer=null;

const $ = sel => document.getElementById(sel);

function paint(){
  $('p1Name').textContent = p1.name;
  $('p2Name').textContent = p2.name;
  $('p1Score').textContent = p1.score;
  $('p2Score').textContent = p2.score;
  $('raceTo').textContent = raceTo;
  $('timer').textContent = sec;

  setImg('imgP1Status', p1.playing ? IMG.p1Status_playing : IMG.p1Status_waiting, 'STATUS');
  setImg('imgP2Status', p2.playing ? IMG.p2Status_playing : IMG.p2Status_waiting, 'STATUS');

  setImg('imgP1Plus', IMG.p1Plus, '+1 POINT');
  setImg('imgP2Plus', IMG.p2Plus, '+1 POINT');

  setImg('imgP1Ext', p1.usedExt ? IMG.p1Ext_used : IMG.p1Ext_ready, 'EXTENSION');
  setImg('imgP2Ext', p2.usedExt ? IMG.p2Ext_used : IMG.p2Ext_ready, 'EXTENSION');

  // If timer is running, show "running" on the Start button; otherwise "start"
  setImg('imgStart', timer ? IMG.running : IMG.start, timer ? 'CLOCK RUNNING' : 'START CLOCK');
  setImg('imgPause', IMG.pause, 'CLOCK PAUSED');
  setImg('imgResetClock', IMG.resetClock, 'RESET CLOCK');

  setImg('imgEditRace', IMG.editRace, 'EDIT RACE');
  setImg('imgEditNameL', IMG.editName, 'EDIT NAME');
  setImg('imgEditNameR', IMG.editName, 'EDIT NAME');
}

/* timer logic */
function tick(){
  sec = Math.max(0, sec-1);
  $('timer').textContent = sec;
  if(sec===0){ stop(); }
}
function start(){
  if(timer) return;
  timer = setInterval(tick, 1000);
  alert('CLOCK STARTED');
  paint(); // flip Start button graphic to "running"
}
function stop(){
  if(timer){ clearInterval(timer); timer=null; }
  paint(); // flip Start button graphic back to "Start"
}
function resetClock(){
  sec = 30;
  $('timer').textContent = sec;
  stop();   // ensures Start shows "Start Clock" after reset
}

/* ---------- Events ---------- */
/* SCORE: +1 should NOT start clock or change who is playing */
$('p1Plus').addEventListener('click', () => {
  p1.score++;
  // allow new extensions in the new frame (optional behavior)
  p1.usedExt=false; p2.usedExt=false;
  paint();
  checkWin();
});
$('p2Plus').addEventListener('click', () => {
  p2.score++;
  p1.usedExt=false; p2.usedExt=false;
  paint();
  checkWin();
});

/* EXTENSION: only for active player, once until a point, and only if time > 0 */
$('p1Ext').addEventListener('click', () => {
  if(p1.playing && !p1.usedExt && sec>0){
    p1.usedExt=true; sec = 30; $('timer').textContent = sec; start();
    paint();
  }
});
$('p2Ext').addEventListener('click', () => {
  if(p2.playing && !p2.usedExt && sec>0){
    p2.usedExt=true; sec = 30; $('timer').textContent = sec; start();
    paint();
  }
});

/* STATUS: clicking the "waiting" switches to "playing" (and other side to waiting) */
$('p1StatusBtn').addEventListener('click', () => {
  if(!p1.playing){ p1.playing = true; p2.playing = false; }
  paint();
});
$('p2StatusBtn').addEventListener('click', () => {
  if(!p2.playing){ p2.playing = true; p1.playing = false; }
  paint();
});

/* CLOCK CONTROLS */
$('startBtn').addEventListener('click', start);

$('pauseBtn').addEventListener('click', () => {
  stop();
  alert('GAME PAUSED');
});

$('resetClockBtn').addEventListener('click', () => {
  resetClock(); // also flips Start image back to "Start"
  paint();
});

/* RESET SCORES */
$('resetScoreBtn').addEventListener('click', () => {
  if(confirm('Reset both scores?')){
    p1.score=0; p2.score=0; p1.usedExt=false; p2.usedExt=false;
    paint();
  }
});

/* EDITS */
$('editRaceBtn').addEventListener('click', () => {
  const v = prompt('Race to:', raceTo);
  const n = Number(v);
  if(Number.isInteger(n) && n>0 && n<100){ raceTo = n; paint(); }
});

$('editP1').addEventListener('click', () => {
  const v = prompt('Player 1 name:', p1.name);
  if(v && v.trim()) p1.name = v.trim().toUpperCase();
  paint();
});
$('editP2').addEventListener('click', () => {
  const v = prompt('Player 2 name:', p2.name);
  if(v && v.trim()) p2.name = v.trim().toUpperCase();
  paint();
});

/* Winner */
function checkWin(){
  if(p1.score>=raceTo || p2.score>=raceTo){
    stop();
    const winner = p1.score>p2.score ? p1.name : p2.name;
    alert(`${winner} wins the race to ${raceTo}!`);
  }
}

/* First render */
paint();
</script>
</body>
</html>
